{
  "id": "auto-secrets-manager",
  "version": "0.0.1",
  "name": "Auto Secrets Manager",
  "description": "Automatically manages environment secrets based on git branches using Infisical with Python backend and shell integration",
  "documentationURL": "https://github.com/your-org/devcontainer-features/tree/main/auto-secrets-manager",
  "licenseURL": "https://github.com/your-org/devcontainer-features/blob/main/LICENSE",
  "keywords": [
    "secrets",
    "environment",
    "git",
    "branch",
    "infisical",
    "security",
    "devcontainer",
    "python",
    "hybrid"
  ],
  "options": {
    "secretManager": {
      "type": "string",
      "enum": ["infisical"],
      "default": "infisical",
      "description": "Secret manager backend to use (currently only Infisical is supported)"
    },
    "shells": {
      "type": "string",
      "enum": ["bash", "zsh", "both"],
      "default": "both",
      "description": "Shell integration support"
    },
    "branchMapping": {
      "type": "string",
      "default": "{}",
      "description": "Git branch to environment mapping (REQUIRED for security - no default mappings provided)"
    },
    "secretManagerConfig": {
      "type": "string",
      "default": "{\"host\":\"https://app.infisical.com\"}",
      "description": "Secret manager configuration (project_id and client_id must be set via this option in case of infisical)"
    },
    "autoCommands": {
      "type": "string",
      "default": "{}",
      "description": "Commands to automatically wrap with secret loading (must be explicitly configured)"
    },
    "cacheConfig": {
      "type": "string",
      "default": "{\"refresh_interval\":\"15m\",\"cleanup_interval\":\"7d\"}",
      "description": "Cache behavior configuration"
    },
    "showEnvInPrompt": {
      "type": "boolean",
      "default": false,
      "description": "Show current environment in shell prompt"
    },
    "markHistory": {
      "type": "boolean",
      "default": false,
      "description": "Mark secrets-related commands in shell history"
    },
    "debug": {
      "type": "boolean",
      "default": false,
      "description": "Enable debug logging and verbose output"
    },
    "branchDetection": {
      "type": "boolean",
      "default": true,
      "description": "Enable branch detection - Disable if you setup git postcheckout hook"
    }
  },
  "postStartCommand": "nohup sh -c 'while true; do auto-secrets-daemon 2>&1 | tee -a /tmp/auto-secrets-daemon.log; sleep 60; done' &",
  "init": true,
  "privileged": false,
  "installsAfter": ["ghcr.io/devcontainers/features/python"]
}
